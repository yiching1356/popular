<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>ğŸ† å®œæ…¶åœ°æ”¿äººæ°£ç‹çˆ­éœ¸æˆ°</title>
    <meta property="og:title" content="ğŸ† å®œæ…¶åœ°æ”¿äººæ°£ç‹çˆ­éœ¸æˆ°">
    <meta property="og:description" content="å®œæ…¶åœ°æ”¿ 2026 æ„Ÿæ©é¤æœƒäººæ°£ç‹æŠ•ç¥¨æ´»å‹•ã€‚æ´»å‹•æˆªæ­¢è‡³ 3/6 ä¸­åˆ 12:00ï¼Œå¿«ä¾†ç‚ºä½ æ”¯æŒçš„åœ˜éšŠæŠ•ä¸‹ä¸€ç¥¨ï¼">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yiching1356.github.io/popular/">

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        :root {
            --yiqing-main: #215440;
            --yiqing-light: #2d6a53;
            --yiqing-gold: #d4af37;
            --glass-bg: rgba(255, 255, 255, 0.95);
        }
        [v-cloak] { display: none; }

        body { 
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; 
            background: radial-gradient(circle at top right, #f0f4f2 0%, #d9e2dd 100%);
            margin: 0; padding: 20px; color: #2c3e50;
            min-height: 100vh;
        }

        .vote-card { 
            width: 100%; max-width: 500px; margin: 0 auto; 
            background: var(--glass-bg); backdrop-filter: blur(10px);
            padding: 35px 25px; border-radius: 40px; 
            box-shadow: 0 20px 60px rgba(33, 84, 64, 0.1);
            border: 1px solid rgba(255,255,255,0.5);
            position: relative;
        }

        .header { text-align: center; margin-bottom: 30px; }
        h1 { color: var(--yiqing-main); font-size: 28px; font-weight: 900; margin: 0; letter-spacing: 1px; }
        .subtitle { 
            font-size: 14px; color: #5d7069; margin-top: 15px; line-height: 1.8;
            border-left: 3px solid var(--yiqing-gold); padding-left: 15px; display: inline-block; text-align: left;
        }

        .countdown-container { 
            background: var(--yiqing-main); color: white; padding: 15px; border-radius: 20px;
            text-align: center; margin: 25px 0; box-shadow: 0 10px 20px rgba(33, 84, 64, 0.2);
        }
        .countdown-label { font-size: 13px; opacity: 0.9; margin-bottom: 5px; font-weight: bold; letter-spacing: 1px; }
        .timer { font-family: 'Inter', monospace; font-size: 22px; font-weight: 800; color: #ffca28; }

        .list-move { transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1); }

        .candidate-item { 
            background: white; border: 1px solid #edf2f0; padding: 20px; border-radius: 24px; 
            margin-bottom: 15px; transition: 0.4s; position: relative;
        }
        .is-leading { border: 1px solid var(--yiqing-gold); box-shadow: 0 10px 25px rgba(212, 175, 55, 0.1); }

        .motivational-tag { 
            font-size: 11px; font-weight: bold; padding: 3px 12px; border-radius: 50px; 
            margin-bottom: 10px; display: inline-block;
        }
        .tag-gold { background: linear-gradient(135deg, #d4af37, #f1d37e); color: #544415; }
        .tag-silver { background: #f1f5f9; color: #64748b; }

        .info-row { display: flex; justify-content: space-between; align-items: center; }
        .name { font-weight: 800; font-size: 17px; color: var(--yiqing-main); }
        .vote-stats { font-weight: 900; color: #1a1a1a; font-size: 20px; }

        .progress-track { height: 8px; background: #f0f4f2; border-radius: 10px; overflow: hidden; margin: 15px 0; }
        .progress-fill { 
            height: 100%; background: var(--yiqing-main); transition: width 1.2s cubic-bezier(0.1, 0.7, 1.0, 0.1); 
            position: relative;
        }
        .progress-fill::after {
            content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 2s infinite;
        }
        @keyframes shine { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }

        .vote-btn { 
            width: 100%; padding: 14px; border: none; border-radius: 15px; 
            font-weight: 800; cursor: pointer; transition: 0.3s; font-size: 15px;
        }
        .btn-ready { background: var(--yiqing-main); color: white; box-shadow: 0 4px 15px rgba(33, 84, 64, 0.1); }
        .btn-ready:hover { background: var(--yiqing-light); transform: translateY(-2px); }
        .btn-voted-target { background: #e8f5e9; color: #2e7d32; cursor: default; }
        .btn-unvoted { background: #f8fafc; color: #94a3b8; border: 1px solid #f1f5f9; cursor: default; }

        .footer { text-align: center; font-size: 11px; color: #94a3b8; margin-top: 35px; letter-spacing: 1px; }
    </style>
</head>
<body>

<div id="app" class="vote-card" v-cloak>
    <div class="header">
        <h1>ğŸ† å®œæ…¶åœ°æ”¿äººæ°£ç‹</h1>
        <div class="subtitle">
            è¬è¬å¤§å®¶é€™ä¸€å¹´ä¾†çš„æ”¯æŒï¼æ­¡è¿æŠ•ä¸‹å–œæ­¡çš„åœ˜éšŠï¼Œç‚ºä»–å€‘åœ¨ <strong>âœ¨ æ„Ÿæ©é¤æœƒ âœ¨</strong> çˆ­å–æœ€é«˜æ¦®è€€ï¼
        </div>
    </div>

    <div class="countdown-container">
        <div class="countdown-label">æŠ•ç¥¨æˆªæ­¢å€’æ•¸</div>
        <div class="timer">{{ countdownText }}</div>
    </div>

    <transition-group name="list" tag="div">
        <div v-for="(p, index) in sortedPlayers" :key="p.name" class="candidate-item" :class="{'is-leading': index === 0 && p.votes > 0}">
            
            <div v-if="p.votes > 0">
                <span v-if="index === 0" class="motivational-tag tag-gold">ğŸ‘‘ ç›®å‰é ˜å…ˆç¬¬ä¸€</span>
                <span v-else-if="index === 1 || index === 2" class="motivational-tag tag-silver">ğŸ¯ åŠ æ²¹ï¼è·é›¢è¶…è¶Šä¸é äº†</span>
                <span v-else class="motivational-tag" style="color:#adb5bd">âœ¨ å…¨åŠ›è¡åˆºä¸­</span>
            </div>

            <div class="info-row">
                <span class="name">{{ p.name }}</span>
                <span class="vote-stats">{{ p.votes }} <small style="font-size: 12px;">ç¥¨</small></span>
            </div>
            
            <div class="progress-track">
                <div class="progress-fill" :class="{'leader-fill': index === 0}" :style="{ width: getPercent(p.votes) + '%' }"></div>
            </div>
            
            <template v-if="!isExpired">
                <button v-if="!hasVoted" class="vote-btn btn-ready" @click="handleVote(p.name)">
                    ğŸ‘ è«‹æ”¯æŒæˆ‘å€‘ï¼æŠ•ä¸€ç¥¨
                </button>
                <button v-else-if="votedTarget === p.name" class="vote-btn btn-voted-target">
                    ğŸ‰ æ„Ÿè¬æ‚¨çš„æ”¯æŒï¼
                </button>
                <button v-else class="vote-btn btn-unvoted">
                    åŠ æ²¹åŠ æ²¹ ğŸ˜­
                </button>
            </template>
            <button v-else class="vote-btn" style="background: #f1f5f9; color: #cbd5e1; cursor: not-allowed;">
                æ´»å‹•å·²æˆªæ­¢
            </button>
        </div>
    </transition-group>

    <div class="footer">
        Â© 2026 YIQING LAND ADMINISTRATION | ç›®å‰ç¸½ç¥¨æ•¸ï¼š{{ totalVotes }}
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBof1GHVYDUHqcsNQWW7grVNNxT_mt8sqA",
        authDomain: "yiqing-vote.firebaseapp.com",
        databaseURL: "https://yiqing-vote-default-rtdb.firebaseio.com",
        projectId: "yiqing-vote",
        storageBucket: "yiqing-vote.firebasestorage.app",
        messagingSenderId: "717925770555",
        appId: "1:717925770555:web:a2554db9a8e2ffe110031e",
        measurementId: "G-TSEDT2MYHK"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const votesRef = db.ref('yiqing_FINAL_VOTES_2026');

    const { createApp } = Vue;
    createApp({
        data() {
            return {
                hasVoted: !!localStorage.getItem('voted_FINAL_2026'),
                votedTarget: localStorage.getItem('voted_target_FINAL'),
                playersData: {
                    'æ°¸åº·æ‰€ âœ¦ å­ç³æ‰€é•·': 0, 'è¯å¹³æ‰€ âœ¦ ç‘œèæ‰€é•·': 0, 'å®‰å¹³æ‰€ âœ¦ ç§€å¦‚æ‰€é•·': 0,
                    'å–„åŒ–æ‰€ âœ¦ ææ•æ‰€é•·': 0, 'æ©‹é ­æ‰€ âœ¦ æƒ å©·æ‰€é•·': 0, 'å˜‰ç¾©æ‰€ âœ¦ ç¾ä¼¶æ‰€é•·': 0,
                    'ç¸½æ‰€ âœ¦ ç…’æ¾‚çµ„': 0, 'ç¸½æ‰€ âœ¦ ä½©å©·çµ„': 0, 'å»ºè¨­éƒ¨': 0
                },
                endTime: new Date("2026-03-06T12:00:00").getTime(),
                countdownText: "",
                isExpired: false
            }
        },
        mounted() {
            // å„ªåŒ–é»ï¼šé€²å…¥ç¶²é æ™‚åƒ…æŠ“å–ä¸€æ¬¡æ•¸æ“šï¼ŒæŠ“å®Œç«‹å³æ–·é–‹é€£ç·šåé¡
            this.refreshData();
            this.updateTimer();
            setInterval(this.updateTimer, 1000);
            // ç‚ºäº†è®“ç•«é¢çœ‹èµ·ä¾†æœ‰åœ¨å‹•ï¼Œæ¯ 30 ç§’è‡ªå‹•å·å·æ›´æ–°ä¸€æ¬¡ (ä¸€æ¨£æ˜¯æŠ“å®Œå°±æ–·)
            setInterval(this.refreshData, 30000);
        },
        computed: {
            sortedPlayers() {
                return Object.keys(this.playersData).map(n => ({ name: n, votes: this.playersData[n] }))
                    .sort((a, b) => b.votes - a.votes);
            },
            totalVotes() { return Object.values(this.playersData).reduce((a, b) => a + b, 0); }
        },
        methods: {
            refreshData() {
                votesRef.get().then((s) => {
                    const data = s.val();
                    if (data) {
                        Object.keys(this.playersData).forEach(k => { 
                            if(data[k] !== undefined) this.playersData[k] = data[k] 
                        });
                    }
                }).catch(err => console.error("é€£ç·šéæ–¼é »ç¹ï¼Œè«‹ç¨å¾Œé‡è©¦"));
            },
            getPercent(v) { return this.totalVotes === 0 ? 0 : ((v / this.totalVotes) * 100).toFixed(1); },
            updateTimer() {
                const now = new Date().getTime();
                const diff = this.endTime - now;
                if (diff <= 0) {
                    this.countdownText = "æŠ•ç¥¨å·²çµæŸ";
                    this.isExpired = true;
                    return;
                }
                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((diff % (1000 * 60)) / 1000);
                this.countdownText = `${d}å¤© ${h}æ™‚ ${m}åˆ† ${s}ç§’`;
            },
            handleVote(name) {
                if (this.hasVoted || this.isExpired) return;
                this.launchConfetti();
                // æŠ•ç¥¨å‹•ä½œæœƒå»ºç«‹çŸ­æš«é€£ç·šï¼Œå¯«å…¥å¾Œæ–·é–‹
                votesRef.child(name).transaction(v => (v || 0) + 1).then(() => {
                    this.refreshData(); // æŠ•å®Œç¥¨æ›´æ–°ä¸€ä¸‹æ•¸æ“š
                });
                this.hasVoted = true;
                this.votedTarget = name;
                localStorage.setItem('voted_FINAL_2026', 'true');
                localStorage.setItem('voted_target_FINAL', name);
            },
            launchConfetti() {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#215440', '#d4af37', '#ffffff'] });
            }
        }
    }).mount('#app');
</script>
</body>
</html>
