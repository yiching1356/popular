<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®œæ…¶åœ°æ”¿äººæ°£ç‹æŠ•ç¥¨</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            --leader-gradient: linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%);
            --bg-color: #f8fafc;
        }

        body { font-family: "PingFang TC", "Heiti TC", "Microsoft JhengHei", sans-serif; background: var(--bg-color); margin: 0; padding: 20px; display: flex; justify-content: center; }
        
        .vote-card { width: 100%; max-width: 550px; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
        
        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #f1f5f9; padding-bottom: 20px; }
        h1 { color: #1e3a8a; margin: 0; font-size: 26px; letter-spacing: 2px; }
        .subtitle { color: #64748b; font-size: 14px; margin-top: 8px; }

        .candidate-list { display: flex; flex-direction: column; gap: 18px; }
        .candidate-item { background: #fff; border: 1px solid #f1f5f9; padding: 15px; border-radius: 12px; transition: 0.3s; }
        .candidate-item.is-leading { border-color: #fbbf24; background: #fffdf5; box-shadow: 0 4px 12px rgba(251, 191, 36, 0.1); }

        .candidate-info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .name { font-weight: bold; font-size: 17px; color: #334155; display: flex; align-items: center; }
        .vote-stats { text-align: right; }
        .vote-count { font-weight: 800; color: #1e3a8a; font-size: 18px; }
        .percent { font-size: 12px; color: #94a3b8; margin-left: 5px; }

        /* é€²åº¦æ¢ */
        .progress-bg { height: 10px; background: #e2e8f0; border-radius: 5px; overflow: hidden; }
        .progress-fill { 
            height: 100%; width: 0%; background: #94a3b8; border-radius: 5px; 
            transition: width 1s cubic-bezier(0.34, 1.56, 0.64, 1); 
        }
        .leader-fill { background: var(--leader-gradient); }
        
        .vote-btn {
            width: 100%; padding: 10px; margin-top: 12px; border: none; border-radius: 8px;
            background: #1e3a8a; color: white; font-weight: bold; cursor: pointer; transition: 0.2s;
        }
        .vote-btn:hover:not(:disabled) { background: #1e40af; transform: translateY(-1px); }
        .vote-btn:disabled { background: #cbd5e1; cursor: not-allowed; }

        .footer-info { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #f1f5f9; }
        .voted-alert { color: #ef4444; font-weight: bold; background: #fee2e2; padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 14px; }
    </style>
</head>
<body>

<div id="app" class="vote-card">
    <div class="header">
        <h1>ğŸ† å®œæ…¶åœ°æ”¿äººæ°£ç‹</h1>
        <div class="subtitle">å³æ™‚æˆ°æ³çµ±è¨ˆ</div>
    </div>

    <div class="candidate-list">
        <div v-for="p in players" :key="p.id" class="candidate-item" :class="{'is-leading': isLeader(p.votes)}">
            <div class="candidate-info">
                <span class="name">
                    <span v-if="isLeader(p.votes)" style="margin-right: 5px;">ğŸ‘‘</span>
                    {{ p.name }}
                </span>
                <div class="vote-stats">
                    <span class="vote-count">{{ p.votes }}</span> <small>ç¥¨</small>
                    <span class="percent">({{ getPercent(p.votes) }}%)</span>
                </div>
            </div>
            <div class="progress-bg">
                <div class="progress-fill" 
                     :class="{'leader-fill': isLeader(p.votes)}"
                     :style="{ width: getPercent(p.votes) + '%' }">
                </div>
            </div>
            <button class="vote-btn" :disabled="hasVoted" @click="handleVote(p.id)">
                {{ hasVoted ? 'å·²å®ŒæˆæŠ•ç¥¨' : 'æŠ•çµ¦æ­¤å–®ä½' }}
            </button>
        </div>
    </div>

    <div class="footer-info">
        <div v-if="hasVoted" class="voted-alert">
            æ‚¨ä»Šæ—¥å·²æŠ•éç¥¨ï¼Œæ¯äººé™æŠ•ä¸€ç¥¨ã€‚
        </div>
        <p style="color: #94a3b8; font-size: 12px;">ç¸½è¨ˆæ”¶ç¥¨æ•¸ï¼š{{ totalVotes }}</p>
    </div>
</div>

<script>
    const { createApp } = Vue;

    createApp({
        data() {
            return {
                hasVoted: false,
                players: [
                    { id: 1, name: 'è¯å¹³æ‰€', votes: 0 },
                    { id: 2, name: 'å®‰å¹³æ‰€', votes: 0 },
                    { id: 3, name: 'å»ºè¨­éƒ¨', votes: 0 },
                    { id: 4, name: 'ç…’æ¾‚çµ„(K01)', votes: 0 },
                    { id: 5, name: 'ä½©å©·çµ„(P01)', votes: 0 },
                    { id: 6, name: 'æ°¸åº·æ‰€', votes: 0 },
                    { id: 7, name: 'æ©‹é ­æ‰€', votes: 0 },
                    { id: 8, name: 'å–„åŒ–æ‰€', votes: 0 },
                    { id: 9, name: 'å˜‰ç¾©æ‰€', votes: 0 }
                ]
            }
        },
        mounted() {
            if (localStorage.getItem('yiqing_voted')) {
                this.hasVoted = true;
            }
            // è®€å–æœ¬åœ°ç¥¨æ•¸ç´€éŒ„
            const savedVotes = localStorage.getItem('yiqing_votes_data');
            if (savedVotes) {
                this.players = JSON.parse(savedVotes);
            }
        },
        computed: {
            totalVotes() {
                return this.players.reduce((sum, p) => sum + p.votes, 0);
            },
            maxVote() {
                const votes = this.players.map(p => p.votes);
                return Math.max(...votes);
            }
        },
        methods: {
            getPercent(votes) {
                if (this.totalVotes === 0) return 0;
                return ((votes / this.totalVotes) * 100).toFixed(1);
            },
            isLeader(votes) {
                return votes === this.maxVote && votes > 0;
            },
            handleVote(id) {
                if (this.hasVoted) return;

                const target = this.players.find(p => p.id === id);
                if (target) {
                    target.votes++;
                    this.hasVoted = true;
                    // å„²å­˜ç‹€æ…‹
                    localStorage.setItem('yiqing_voted', 'true');
                    localStorage.setItem('yiqing_votes_data', JSON.stringify(this.players));
                }
            }
        }
    }).mount('#app');
</script>

</body>
</html>
