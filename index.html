<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ† å®œæ…¶åœ°æ”¿äººæ°£ç‹çˆ­éœ¸æˆ°</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    <style>
        :root {
            --yiqing-blue: #1e3a8a;
            --yiqing-gold: #f59e0b;
            --leader-bg: #fffcf0;
        }

        body { 
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; 
            background: #0f172a; /* æ·±è‰²èƒŒæ™¯æ›´æœ‰ç«¶æŠ€æ„Ÿ */
            margin: 0; padding: 20px; color: white;
        }
        
        .vote-card { 
            width: 100%; max-width: 600px; margin: 0 auto;
            background: #1e293b; padding: 25px; border-radius: 28px; 
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); 
        }
        
        .header { text-align: center; margin-bottom: 30px; }
        h1 { 
            background: linear-gradient(to right, #fbbf24, #f59e0b);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            font-size: 32px; margin: 0; font-weight: 900;
        }
        .subtitle { color: #94a3b8; font-size: 14px; margin-top: 10px; letter-spacing: 2px; }

        /* åˆ—è¡¨éæ¸¡å‹•ç•«ï¼šé€™æ˜¯å³æ™‚æ’åç§»å‹•çš„æ ¸å¿ƒ */
        .list-move, .list-enter-active, .list-leave-active {
            transition: all 0.6s cubic-bezier(0.55, 0, 0.1, 1);
        }
        .list-enter-from, .list-leave-to { opacity: 0; transform: scale(0.9); }

        .candidate-item { 
            background: #334155; border: 1px solid #475569; padding: 18px; 
            border-radius: 20px; margin-bottom: 12px; position: relative;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        /* é ˜å…ˆè€…ç™¼å…‰ç‰¹æ•ˆ */
        .is-leading { 
            border: 2px solid var(--yiqing-gold); 
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.3);
            background: #334155;
        }

        .info-row { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 10px; }
        .name { font-weight: bold; font-size: 18px; color: #f8fafc; }
        .vote-stats { font-family: 'Courier New', monospace; font-size: 22px; color: var(--yiqing-gold); font-weight: 900; }

        .progress-track { height: 16px; background: #0f172a; border-radius: 8px; overflow: hidden; margin-bottom: 10px; }
        .progress-fill { 
            height: 100%; width: 0%; background: #64748b; border-radius: 8px; 
            transition: width 1s ease-in-out; 
        }
        .leader-fill { 
            background: linear-gradient(90deg, #f59e0b, #fbbf24, #f59e0b); 
            background-size: 200% 100%;
            animation: shine 2s linear infinite;
        }
        @keyframes shine { 0% {background-position: 200% 0;} 100% {background-position: -200% 0;} }

        .vote-btn { 
            width: 100%; padding: 12px; border: none; border-radius: 12px;
            background: linear-gradient(135deg, #3b82f6 0%, #1e3a8a 100%);
            color: white; font-weight: bold; cursor: pointer; font-size: 16px;
            box-shadow: 0 4px 0 #1e3a8a;
        }
        .vote-btn:active { transform: translateY(2px); box-shadow: 0 2px 0 #1e3a8a; }
        .vote-btn:disabled { background: #475569; box-shadow: none; color: #94a3b8; cursor: not-allowed; }

        .alert-voted { 
            text-align: center; color: #fca5a5; background: rgba(239, 68, 68, 0.1); 
            padding: 10px; border-radius: 10px; margin-bottom: 20px; font-weight: bold;
        }
        .total-badge { text-align: center; font-size: 14px; color: #64748b; margin-top: 20px; }
    </style>
</head>
<body>

<div id="app" class="vote-card">
    <div class="header">
        <h1>ğŸ† å®œæ…¶åœ°æ”¿äººæ°£ç‹</h1>
        <div class="subtitle">REAL-TIME LEADERBOARD</div>
    </div>

    <div v-if="hasVoted" class="alert-voted">å·²é–å®šæŠ•ç¥¨é¸æ“‡ï¼Œçµæœå³æ™‚åŒæ­¥ä¸­</div>

    <transition-group name="list" tag="div" class="candidate-list">
        <div v-for="p in sortedPlayers" :key="p.name" class="candidate-item" :class="{'is-leading': isLeader(p.votes)}">
            <div class="info-row">
                <span class="name">
                    <span v-if="isLeader(p.votes)">ğŸ‘‘ </span>{{ p.name }}
                </span>
                <span class="vote-stats">{{ p.votes }} <small style="font-size: 12px;">ç¥¨</small></span>
            </div>
            <div class="progress-track">
                <div class="progress-fill" :class="{'leader-fill': isLeader(p.votes)}" :style="{ width: getPercent(p.votes) + '%' }"></div>
            </div>
            <button class="vote-btn" :disabled="hasVoted" @click="handleVote(p.name)">
                {{ hasVoted ? 'æ„Ÿè¬æ”¯æŒ' : 'æŠ•çµ¦æ­¤å–®ä½' }}
            </button>
        </div>
    </transition-group>

    <div class="total-badge">
        ç›®å‰ç´¯ç©æŠ•ç¥¨ï¼š{{ totalVotes }} ç¥¨
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBof1GHVYDUHqcsNQWW7grVNNxT_mt8sqA",
        authDomain: "yiqing-vote.firebaseapp.com",
        databaseURL: "https://yiqing-vote-default-rtdb.firebaseio.com",
        projectId: "yiqing-vote",
        storageBucket: "yiqing-vote.firebasestorage.app",
        messagingSenderId: "717925770555",
        appId: "1:717925770555:web:a2554db9a8e2ffe110031e",
        measurementId: "G-TSEDT2MYHK"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const votesRef = db.ref('yiqing_2026_votes');

    const { createApp } = Vue;
    createApp({
        data() {
            return {
                hasVoted: localStorage.getItem('voted_yiqing_2026'),
                // é€™è£¡å®šç¾©é †åºï¼Œæ¸²æŸ“æ™‚æœƒä¾ç…§ç¥¨æ•¸é‡æ–°æ’åˆ—ï¼Œè‹¥ç¥¨æ•¸ä¸€æ¨£å‰‡ä¾ç…§æ­¤é †åº
                playersData: {
                    'æ°¸åº·æ‰€ âœ¦ å­ç³æ‰€é•·': 0,
                    'è¯å¹³æ‰€ âœ¦ ç‘œèæ‰€é•·': 0,
                    'å®‰å¹³æ‰€ âœ¦ ç§€å¦‚æ‰€é•·': 0,
                    'å–„åŒ–æ‰€ âœ¦ ææ•æ‰€é•·': 0,
                    'æ©‹é ­æ‰€ âœ¦ æƒ å©·æ‰€é•·': 0,
                    'ç¸½æ‰€ âœ¦ ç…’æ¾‚çµ„': 0,
                    'ç¸½æ‰€ âœ¦ ä½©å©·çµ„': 0,
                    'å˜‰ç¾©æ‰€ âœ¦ ç¾ä¼¶æ‰€é•·': 0,
                    'å»ºè¨­éƒ¨': 0
                }
            }
        },
        mounted() {
            votesRef.on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    Object.keys(this.playersData).forEach(key => {
                        if (data[key] !== undefined) this.playersData[key] = data[key];
                    });
                }
            });
        },
        computed: {
            // å°‡å°è±¡è½‰æ›ç‚ºé™£åˆ—ä¸¦æŒ‰ç¥¨æ•¸æ’åºï¼ˆåˆºæ¿€æ„Ÿçš„æ ¸å¿ƒï¼šè‡ªå‹•æ’åï¼‰
            sortedPlayers() {
                return Object.keys(this.playersData)
                    .map(name => ({ name, votes: this.playersData[name] }))
                    .sort((a, b) => b.votes - a.votes);
            },
            totalVotes() {
                return Object.values(this.playersData).reduce((a, b) => a + b, 0);
            },
            maxVote() {
                return Math.max(...Object.values(this.playersData));
            }
        },
        methods: {
            getPercent(votes) {
                if (this.totalVotes === 0) return 0;
                return ((votes / this.totalVotes) * 100).toFixed(1);
            },
            isLeader(votes) {
                return votes === this.maxVote && votes > 0;
            },
            handleVote(name) {
                if (this.hasVoted) return;
                votesRef.child(name).transaction((cv) => (cv || 0) + 1);
                this.hasVoted = true;
                localStorage.setItem('voted_yiqing_2026', 'true');
            }
        }
    }).mount('#app');
</script>
</body>
</html>
</body>
</html>
